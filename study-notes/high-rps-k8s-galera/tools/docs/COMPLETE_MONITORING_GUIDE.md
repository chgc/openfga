# å®Œæ•´ç›£æ§å·¥å…·å°æ¯”æŒ‡å—

## ä¸‰ç¨®ç›£æ§æ–¹å¼å°æ¯”

### æ–¹å¼ 1: åŸç‰ˆ kubectl æª¢æŸ¥å·¥å…·

**æ–‡ä»¶**: `k8s_deployment_checker.py`

```bash
python k8s_deployment_checker.py
```

#### ç‰¹é»

| ç‰¹æ€§ | èªªæ˜ |
|------|------|
| **éœ€æ±‚** | âœ… kubectl è¨ªå•æ¬Šé™ |
| **å¯¦æ™‚æ€§** | âœ… å¯¦æ™‚æŸ¥è©¢ |
| **æ•¸æ“šæŒä¹…åŒ–** | âŒ ç„¡ |
| **å‘Šè­¦åŠŸèƒ½** | âŒ ç„¡ |
| **å¯è¦–åŒ–** | âŒ ç´” CLI |
| **å®‰å…¨æ€§** | âš ï¸ éœ€è¦é›†ç¾¤è¨ªå•æ¬Šé™ |
| **è·¨é›†ç¾¤** | âŒ å–®é›†ç¾¤ |
| **Web è¨ªå•** | âŒ å¿…é ˆæœ¬æ©Ÿæˆ– SSH |

#### ç›£æ§å…§å®¹

- âœ… Pod ç‹€æ…‹å’Œå°±ç·’æ•¸
- âœ… Namespace æª¢æŸ¥
- âœ… MySQL é€£æ¥æ•¸
- âœ… Galera é›†ç¾¤ç‹€æ…‹
- âœ… è³‡æºä½¿ç”¨ï¼ˆéœ€è¦ metrics-serverï¼‰
- âŒ æ­·å²æ•¸æ“š
- âŒ æ€§èƒ½è¶¨å‹¢

#### é©ç”¨å ´æ™¯

- éƒ¨ç½²å¾Œå¿«é€Ÿæª¢æŸ¥
- ç’°å¢ƒæº–å‚™é©—è­‰
- èª¿è©¦å’Œæ’æŸ¥

---

### æ–¹å¼ 2: é›¢ç·šé…ç½®æª¢æŸ¥å·¥å…·

**æ–‡ä»¶**: `k8s_deployment_checker_offline.py`

```bash
python k8s_deployment_checker_offline.py
# é¸æ“‡ 1: åˆ†æ YAML æ–‡ä»¶
```

#### ç‰¹é»

| ç‰¹æ€§ | èªªæ˜ |
|------|------|
| **éœ€æ±‚** | âŒ ç„¡éœ€ä»»ä½•è¨ªå•æ¬Šé™ |
| **å¯¦æ™‚æ€§** | âŒ éœæ…‹åˆ†æ |
| **æ•¸æ“šæŒä¹…åŒ–** | âŒ ç„¡ |
| **å‘Šè­¦åŠŸèƒ½** | âŒ ç„¡ |
| **å¯è¦–åŒ–** | âŒ ç´” CLI |
| **å®‰å…¨æ€§** | âœ… å®Œå…¨å®‰å…¨ |
| **è·¨é›†ç¾¤** | âœ… ä»»æ„é›†ç¾¤é…ç½® |
| **æ™‚æ©Ÿ** | âœ… éƒ¨ç½²å‰/å¾Œ |

#### ç›£æ§å…§å®¹

- âœ… YAML é…ç½®æª¢æŸ¥
- âœ… è³‡æºè¦æ ¼é©—è­‰
- âœ… é€£æ¥æ± é…ç½®æª¢æŸ¥
- âœ… é«˜å¯ç”¨æ€§é©—è­‰
- âœ… è³‡æºç¸½è¨ˆè¨ˆç®—
- âŒ å¯¦æ™‚é‹è¡Œç‹€æ…‹
- âŒ å¯¦éš›æ€§èƒ½æ•¸æ“š

#### é©ç”¨å ´æ™¯

- **éƒ¨ç½²å‰é©—è­‰** âœ…
- é…ç½®å¯©è¨ˆ
- DevOps è‡ªå‹•åŒ–
- CI/CD æµç¨‹
- æ²’æœ‰é›†ç¾¤è¨ªå•æ¬Šé™

---

### æ–¹å¼ 3: Prometheus å¯¦æ™‚ç›£æ§å·¥å…·

**æ–‡ä»¶**: `k8s_prometheus_monitor.py`

```bash
python k8s_prometheus_monitor.py
# é¸æ“‡ 1-4
```

#### ç‰¹é»

| ç‰¹æ€§ | èªªæ˜ |
|------|------|
| **éœ€æ±‚** | âœ… Prometheus HTTP è¨ªå•ï¼ˆç„¡éœ€ kubectlï¼‰ |
| **å¯¦æ™‚æ€§** | âœ… å¯¦æ™‚ 15 ç§’ä¸€æ¬¡ |
| **æ•¸æ“šæŒä¹…åŒ–** | âœ… ä¿ç•™ 30 å¤© |
| **å‘Šè­¦åŠŸèƒ½** | âœ… å…§ç½®å‘Šè­¦è¦å‰‡ |
| **å¯è¦–åŒ–** | âœ… Grafana æ”¯æŒ |
| **å®‰å…¨æ€§** | âœ… å¯é™åˆ¶è¨ªå• |
| **è·¨é›†ç¾¤** | âœ… è¯åˆç›£æ§ |
| **æ€§èƒ½é–‹éŠ·** | âš ï¸ éœ€è¦ç›£æ§åŸºç¤è¨­æ–½ |

#### ç›£æ§å…§å®¹

- âœ… Pod ç‹€æ…‹å’Œå°±ç·’æ•¸
- âœ… CPU å’Œ Memory ä½¿ç”¨ï¼ˆåœ–è¡¨ï¼‰
- âœ… Network I/O
- âœ… MySQL é€£æ¥ã€æŸ¥è©¢ã€è¤‡è£½
- âœ… Galera é›†ç¾¤ç‹€æ…‹
- âœ… 30 å¤©æ­·å²æ•¸æ“š
- âœ… è‡ªå‹•å‘Šè­¦
- âœ… èˆ‡ Grafana é›†æˆ

#### é©ç”¨å ´æ™¯

- **é•·æœŸç›£æ§** âœ…
- æ€§èƒ½åˆ†æ
- å®¹é‡è¦åŠƒ
- å‘Šè­¦é€šçŸ¥
- æ²’æœ‰ kubectl æ¬Šé™ä½†æœ‰ Prometheus

---

## ä½¿ç”¨æ±ºç­–æ¨¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä½ éœ€è¦ä»€éº¼ï¼Ÿ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚
    â‘ å¿«é€Ÿæª¢æŸ¥           â‘¡é•·æœŸç›£æ§
    éƒ¨ç½²ç‹€æ…‹             æ€§èƒ½åˆ†æ
        â”‚                   â”‚
        â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ kubectl â”‚         â”‚Prometheusâ”‚
    â”‚æª¢æŸ¥å·¥å…· â”‚         â”‚ç›£æ§å·¥å…·  â”‚
    â”‚éœ€è¦æ¬Šé™ â”‚         â”‚ç„¡éœ€æ¬Šé™  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ï¼ˆHTTPè¨ªå•ï¼‰
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚æœ‰ Prometheus?    â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
             â”‚æ˜¯       â”‚å¦
             â”‚         â”‚
             â–¼         â–¼
          ç”¨â‘¢       ç”¨â‘ +â‘¡
```

## å·¥ä½œæµç¨‹å»ºè­°

### å ´æ™¯ A: é–‹ç™¼ç’°å¢ƒï¼ˆæœ¬åœ°ï¼‰

```
1ï¸âƒ£ ç·¨å¯« YAML é…ç½®
   â”‚
   â–¼
2ï¸âƒ£ ä½¿ç”¨ã€é›¢ç·šå·¥å…·ã€‘é©—è­‰é…ç½®
   python k8s_deployment_checker_offline.py
   
3ï¸âƒ£ éƒ¨ç½²åˆ° minikube/Kind
   kubectl apply -f deployment.yaml
   
4ï¸âƒ£ ä½¿ç”¨ã€kubectl æª¢æŸ¥å·¥å…·ã€‘é©—è­‰éƒ¨ç½²
   python k8s_deployment_checker.py
   
5ï¸âƒ£ æ¸¬è©¦æ‡‰ç”¨ç¨‹åº
```

### å ´æ™¯ B: ç”Ÿç”¢ç’°å¢ƒï¼ˆæœ‰ Prometheusï¼‰

```
1ï¸âƒ£ æº–å‚™éšæ®µ
   â”‚
   â”œâ”€ ä½¿ç”¨ã€é›¢ç·šå·¥å…·ã€‘é©—è­‰é…ç½®
   â”‚  python k8s_deployment_checker_offline.py
   â”‚
   â””â”€ éƒ¨ç½² Prometheus å’Œ exporters
      kubectl apply -f prometheus-deployment.yaml
      kubectl apply -f mysql-exporter-deployment.yaml

2ï¸âƒ£ éƒ¨ç½²æ‡‰ç”¨
   kubectl apply -f openfga-deployment.yaml

3ï¸âƒ£ å¯¦æ™‚ç›£æ§
   python k8s_prometheus_monitor.py
   # é¸æ“‡æŒçºŒç›£æ§

4ï¸âƒ£ é•·æœŸåˆ†æ
   # Prometheus Web UI æˆ– Grafana
   
5ï¸âƒ£ å‘Šè­¦éŸ¿æ‡‰
   # åŸºæ–¼ Prometheus å‘Šè­¦è¦å‰‡
```

### å ´æ™¯ C: æœ‰é™æ¬Šé™ï¼ˆç„¡ kubectlï¼Œæœ‰ Prometheusï¼‰

```
1ï¸âƒ£ æ”¶å– YAML é…ç½®æ–‡ä»¶
   â”‚
2ï¸âƒ£ ä½¿ç”¨ã€é›¢ç·šå·¥å…·ã€‘é©—è­‰
   python k8s_deployment_checker_offline.py
   
3ï¸âƒ£ ç¢ºèª Prometheus åœ°å€
   
4ï¸âƒ£ ä½¿ç”¨ã€Prometheus å·¥å…·ã€‘ç›£æ§
   python k8s_prometheus_monitor.py
   
5ï¸âƒ£ å‘Šè­¦å’Œåˆ†æ
   # æŒçºŒç›£æ§ï¼Œè¨­ç½®å‘Šè­¦
```

## ç›£æ§æŒ‡æ¨™å°æ‡‰è¡¨

| ç›£æ§é … | kubectl å·¥å…· | é›¢ç·šå·¥å…· | Prometheus å·¥å…· |
|--------|----------|--------|----------------|
| Pod å°±ç·’æ•¸ | âœ… | âŒ | âœ… |
| Pod ç‹€æ…‹è©³æƒ… | âœ… | âŒ | âœ… |
| CPU ä½¿ç”¨ï¼ˆå¯¦æ™‚ï¼‰ | âœ… | âŒ | âœ… |
| Memory ä½¿ç”¨ï¼ˆå¯¦æ™‚ï¼‰ | âœ… | âŒ | âœ… |
| Network I/O | âŒ | âŒ | âœ… |
| MySQL é€£æ¥ | âœ… | âŒ | âœ… |
| Galera ç‹€æ…‹ | âœ… | âŒ | âœ… |
| **é…ç½®é©—è­‰** | âŒ | âœ… | âŒ |
| **è³‡æºè¦æ ¼** | âŒ | âœ… | âŒ |
| **é€£æ¥æ± è¨­ç½®** | âŒ | âœ… | âŒ |
| **æ­·å²æ•¸æ“š** | âŒ | âŒ | âœ… 30å¤© |
| **æ€§èƒ½è¶¨å‹¢** | âŒ | âŒ | âœ… |
| **å‘Šè­¦è¦å‰‡** | âŒ | âŒ | âœ… |
| **Grafana é›†æˆ** | âŒ | âŒ | âœ… |

## å¿«é€Ÿåƒè€ƒå‘½ä»¤

### é›¢ç·šæª¢æŸ¥ï¼ˆä»»ä½•åœ°æ–¹ï¼‰
```bash
python k8s_deployment_checker_offline.py
# è¼¸å…¥ YAML æ–‡ä»¶è·¯å¾‘
```

### kubectl æª¢æŸ¥ï¼ˆéœ€è¦ kubeconfigï¼‰
```bash
python k8s_deployment_checker.py
# è¼¸å…¥ namespace
```

### Prometheus ç›£æ§ï¼ˆéœ€è¦ Prometheus URLï¼‰
```bash
python k8s_prometheus_monitor.py
# è¼¸å…¥ Prometheus åœ°å€
```

### éƒ¨ç½² Prometheus
```bash
kubectl apply -f prometheus-deployment.yaml
kubectl apply -f mysql-exporter-deployment.yaml
```

### è¨ªå• Prometheus UI
```bash
kubectl port-forward -n monitoring svc/prometheus 9090:9090
# è¨ªå• http://localhost:9090
```

## æˆæœ¬æ•ˆç›Šåˆ†æ

| å·¥å…· | éƒ¨ç½²æˆæœ¬ | å­¸ç¿’æ›²ç·š | åŠŸèƒ½å®Œæ•´åº¦ | ROI |
|------|---------|---------|----------|-----|
| kubectl | ä½ | ä½ | ä¸­ | é«˜ |
| é›¢ç·šå·¥å…· | 0 | ä½ | ä½ | é«˜ |
| Prometheus | ä¸­ | ä¸­ | é«˜ | ä¸­-é«˜ |
| ä¸‰åˆä¸€ | ä¸­ | ä¸­ | é«˜ | **æœ€é«˜** |

## æ¨è–¦é…ç½®

### æ¨è–¦ 1: å°å‹åœ˜éšŠï¼ˆç„¡ç›£æ§åŸºç¤è¨­æ–½ï¼‰
```
é›¢ç·šå·¥å…· + kubectl å·¥å…·
éœ€æ±‚: YAML æ–‡ä»¶ + kubeconfig
åŠŸèƒ½: éƒ¨ç½²å‰é©—è­‰ + éƒ¨ç½²å¾Œæª¢æŸ¥
```

### æ¨è–¦ 2: ä¸­å‹åœ˜éšŠï¼ˆæœ‰åŸºç¤è¨­æ–½ï¼‰
```
é›¢ç·šå·¥å…· + Prometheus å·¥å…·
éœ€æ±‚: YAML æ–‡ä»¶ + Prometheus HTTP è¨ªå•
åŠŸèƒ½: éƒ¨ç½²å‰é©—è­‰ + å¯¦æ™‚ç›£æ§ + å‘Šè­¦
```

### æ¨è–¦ 3: å¤§å‹ä¼æ¥­ï¼ˆç”Ÿç”¢ç’°å¢ƒï¼‰
```
ä¸‰åˆä¸€: é›¢ç·šå·¥å…· + kubectl å·¥å…· + Prometheus å·¥å…·
+ Grafana + Alertmanager
åŠŸèƒ½: å®Œæ•´çš„ DevOps ç›£æ§é«”ç³»
```

## ç¸½çµ

| æ™‚æ©Ÿ | æ¨è–¦å·¥å…· | åŸå›  |
|------|---------|------|
| **éƒ¨ç½²å‰** | ğŸŸ¢ é›¢ç·šå·¥å…· | ç„¡éœ€æ¬Šé™ï¼Œå¿«é€Ÿé©—è­‰ |
| **éƒ¨ç½²ç›´å¾Œ** | ğŸŸ¡ kubectl å·¥å…· | å¿«é€Ÿæª¢æŸ¥éƒ¨ç½²ç‹€æ…‹ |
| **æ—¥å¸¸ç›£æ§** | ğŸ”´ Prometheus å·¥å…· | é•·æœŸç›£æ§ï¼Œæ•¸æ“šä¿ç•™ï¼Œå‘Šè­¦ |
| **å•é¡Œæ’æŸ¥** | ğŸ”´ kubectl + Prometheus | çµåˆå¯¦æ™‚ + æ­·å²æ•¸æ“š |
| **æ€§èƒ½åˆ†æ** | ğŸŸ¢ Prometheus + Grafana | å¯è¦–åŒ–è¶¨å‹¢åˆ†æ |

**ä¸‰å€‹å·¥å…·å”åŒä½¿ç”¨ï¼Œèƒ½è¦†è“‹å¾é–‹ç™¼åˆ°é‹ç¶­çš„å®Œæ•´ç›£æ§éœ€æ±‚ï¼**
